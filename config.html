<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Configuration</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Configuration</h1>
    <nav><a href="index.html">‚Üê Retour</a></nav>
  </header>

  <main>
    <h2>Appareils</h2>
    <div id="appareils-container"></div>
    <button onclick="ajouterAppareil()">Ajouter un appareil</button>

    <h2>Heures creuses</h2>
    <div id="hc-container"></div>
    <button onclick="ajouterHC()">Ajouter une plage</button>

    <br><br>
    <button onclick="sauvegarder()">üíæ Sauvegarder</button>
  </main>

  <script src="config.js"></script>
  <script>
    function createInput(value = '', placeholder = '') {
      const input = document.createElement('input');
      input.value = value;
      input.placeholder = placeholder;
      return input;
    }

    function chargerFormulaires() {
      const appContainer = document.getElementById('appareils-container');
      appContainer.innerHTML = '';
      appareils.forEach((app, i) => {
        const div = document.createElement('div');
        div.innerHTML = `<b>Appareil ${i + 1}</b><br>`;
        div.appendChild(createInput(app.nom, 'Nom'));
        div.appendChild(createInput(app.duree, 'Dur√©e en minutes'));
        const select = document.createElement('select');
        ['debut', 'fin'].forEach(opt => {
          const o = document.createElement('option');
          o.value = opt;
          o.textContent = opt;
          if (opt === app.type) o.selected = true;
          select.appendChild(o);
        });
        div.appendChild(select);
        appContainer.appendChild(div);
      });

      const hcContainer = document.getElementById('hc-container');
      hcContainer.innerHTML = '';
      heuresCreuses.forEach((hc, i) => {
        const div = document.createElement('div');
        div.innerHTML = `<b>Plage ${i + 1}</b><br>`;
        div.appendChild(createInput(hc.nom, 'Nom'));
        div.appendChild(createInput(hc.debut, 'D√©but (hh:mm)'));
        div.appendChild(createInput(hc.fin, 'Fin (hh:mm)'));
        hcContainer.appendChild(div);
      });
    }

    function ajouterAppareil() {
      appareils.push({ nom: 'Nouvel appareil', duree: 60, type: 'debut' });
      chargerFormulaires();
    }

    function ajouterHC() {
      heuresCreuses.push({ nom: 'Nouvelle HC', debut: '00:00', fin: '00:00' });
      chargerFormulaires();
    }

    function sauvegarder() {
      const newApps = [];
      document.querySelectorAll('#appareils-container > div').forEach(div => {
        const [nom, duree, type] = div.querySelectorAll('input, select');
        newApps.push({ nom: nom.value, duree: parseInt(duree.value), type: type.value });
      });

      const newHC = [];
      document.querySelectorAll('#hc-container > div').forEach(div => {
        const [nom, debut, fin] = div.querySelectorAll('input');
        newHC.push({
          nom: nom.value,
          debut: debut.value,
          fin: fin.value
        });
      });

      localStorage.setItem('appareils', JSON.stringify(newApps));
      localStorage.setItem('heuresCreuses', JSON.stringify(newHC));
      alert('Configuration sauvegard√©e.');
    }

    chargerFormulaires();
  </script>
</body>
</html>